app-id: io.qt.qtdesignstudio
runtime: org.kde.Sdk
runtime-version: '6.9'
base: io.qt.qtwebengine.BaseApp
base-version: '6.9'
sdk: org.kde.Sdk
command: qtdesignstudio
rename-icon: QtProject-qtdesignstudio
finish-args:
  - --share=ipc
  - --share=network
  - --socket=x11
  - --socket=ssh-auth
  - --filesystem=host
  - --device=dri
  - --allow=devel
  - --env=QTWEBENGINEPROCESS_PATH=/app/bin/QtWebEngineProcess
  - --env=QML_IMPORT_PATH=/app/lib/qml
  - --env=QT_QPA_PLATFORM=xcb
modules:
  - name: qtquickdesigner-components
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
    sources:
      - type: git
        url: https://code.qt.io/qt-labs/qtquickdesigner-components
        tag: qds-dev-4.7
        commit: 5eb7b9257de974ef0b3a4b128c0adf5ed24517f1
        x-checker-data:
          type: git
          tag-pattern: ^qds-dev-(\d+\.\d+\.?\d*)$
  - name: linker-setup
    buildsystem: simple
    build-commands:
      - install -Dm644 ld.so.conf /app/etc/ld.so.conf
    sources:
      - type: inline
        dest-filename: ld.so.conf
        contents: |
          /app/lib/x86_64-linux-gnu
  - name: qt-creator
    buildsystem: cmake-ninja
    config-opts:
      - -DCMAKE_BUILD_TYPE=Release
      - -DSHOW_BUILD_DATE=ON
      - -DWITH_ONLINE_DOCS=ON
      - -DBUILD_DEVELOPER_DOCS=ON
      - -DBUILD_DESIGNSTUDIO=ON
      - -DFETCHCONTENT_SOURCE_DIR_EFSW=efsw
      - -DFETCHCONTENT_SOURCE_DIR_QDS_QML_IMPORT_OVERRIDE=qml_override
      - -DQDS_AUTO_INSTALL_QUICK_DESIGNER_COMPONENTS=OFF
      - -Wno-dev
    sources:
      - type: git
        url: https://github.com/SpartanJ/efsw.git
        tag: 1.5.0
        commit: 112e89c00f362709b887b65199694ef061519ebb
        dest: efsw
      - type: git
        url: https://git.qt.io/design-studio/qds-qml-import-override.git
        tag: qds-4.8.0-beta4
        commit: 87b7cf77d5cc754e7e921d78767f6c50aece7642
        dest: qml_override
      - type: git
        url: https://code.qt.io/qt-creator/qt-creator
        tag: qds/v4.8.1
        commit: 9129b18a0a136a02f3e0947ced036b77118890c6
        x-checker-data:
          type: git
          tag-pattern: ^qds\/v(\d+\.\d+\.?\d*)$
  - name: docs
    buildsystem: simple
    sources:
      - type: archive
        url: https://download.qt.io/online/qtsdkrepository/linux_x64/desktop/tools_qtdesignstudio_generation2/qt.tools.qtdesignstudio/4.8.1-0-202511211723docs.7z
        sha256: 9f6e3f475ab711e012d7ced42a3e0695a373b15b9fb8be9b32836a74ecf061ae
        x-checker-data:
          type: html
          url: https://download.qt.io/online/qtsdkrepository/linux_x64/desktop/tools_qtdesignstudio_generation2/Updates.xml
          version-pattern: <Version>([2-9].+)<\/Version>
          url-template: https://download.qt.io/online/qtsdkrepository/linux_x64/desktop/tools_qtdesignstudio_generation2/qt.tools.qtdesignstudio/$versiondocs.7z
    build-commands:
      - mkdir -p $FLATPAK_DEST/share/doc/qtcreator
      - cp * $FLATPAK_DEST/share/doc/qtcreator
